<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mastering JavaScript Fetch API - Lesson 1 | rws8.tech</title>
    <meta name="description" content="Learn the JavaScript Fetch API - make HTTP requests with modern async syntax.">
    <link rel="stylesheet" href="/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
    <style>
        .lesson-content {
            max-width: 800px;
            margin: 0 auto;
            padding: 2rem 1rem;
        }
        .objectives-box {
            background: #f8f9fa;
            border-left: 4px solid #007bff;
            padding: 1.5rem;
            margin: 2rem 0;
        }
        .objectives-box h3 {
            margin-top: 0;
            color: #007bff;
        }
        .lesson-nav {
            display: flex;
            justify-content: space-between;
            margin-top: 3rem;
            padding-top: 2rem;
            border-top: 2px solid #e9ecef;
        }
        .tip-box {
            background: #d1ecf1;
            border-left: 4px solid #17a2b8;
            padding: 1rem;
            margin: 1rem 0;
        }
        .warning-box {
            background: #f8d7da;
            border-left: 4px solid #dc3545;
            padding: 1rem;
            margin: 1rem 0;
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="container">
            <a href="/" class="logo">rws8.tech</a>
            <ul class="nav-links">
                <li><a href="/">Home</a></li>
                <li><a href="/tutorials.html">Tutorials</a></li>
                <li><a href="/about.html">About</a></li>
            </ul>
        </div>
    </nav>

    <div class="breadcrumbs">
        <div class="container">
            <a href="/">Home</a> &gt; 
            <a href="/tutorials.html">Tutorials</a> &gt; 
            <a href="/tutorials/javascript/index.html">JavaScript</a> &gt; 
            <a href="index.html">Fetch API</a> &gt; 
            <span>Lesson 1</span>
        </div>
    </div>

    <header class="page-header">
        <div class="container">
            <h1>Mastering the Fetch API</h1>
            <p class="subtitle">Modern HTTP Requests</p>
        </div>
    </header>

    <main class="content-section">
        <div class="lesson-content">
            <div class="objectives-box">
                <h3>Learning Objectives</h3>
                <ul>
                    <li>Make GET and POST requests with fetch</li>
                    <li>Handle responses and errors properly</li>
                    <li>Send JSON data and custom headers</li>
                    <li>Use async/await with fetch</li>
                    <li>Apply fetch best practices</li>
                </ul>
            </div>

            <h2>Basic GET Request</h2>

            <pre><code class="language-javascript">// Simple GET request with Promises
fetch('https://api.example.com/users')
    .then(response => response.json())
    .then(data => {
        console.log('Users:', data);
    })
    .catch(error => {
        console.error('Error:', error);
    });

// With async/await (recommended)
async function getUsers() {
    try {
        const response = await fetch('https://api.example.com/users');
        const data = await response.json();
        console.log('Users:', data);
        return data;
    } catch (error) {
        console.error('Error:', error);
        throw error;
    }
}

// Usage
const users = await getUsers();
</code></pre>

            <h2>POST Request</h2>

            <pre><code class="language-javascript">async function createUser(userData) {
    const response = await fetch('https://api.example.com/users', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify(userData)
    });
    
    if (!response.ok) {
        throw new Error(`HTTP error! status: ${response.status}`);
    }
    
    const data = await response.json();
    return data;
}

// Usage
const newUser = await createUser({
    name: 'John Doe',
    email: 'john@example.com',
    age: 30
});

console.log('Created user:', newUser);
</code></pre>

            <h2>Error Handling</h2>

            <div class="warning-box">
                <strong>Important:</strong> Fetch only rejects on network errors, not HTTP errors (404, 500, etc.)!
            </div>

            <pre><code class="language-javascript">async function fetchWithErrorHandling(url) {
    try {
        const response = await fetch(url);
        
        // Check if response is OK (status 200-299)
        if (!response.ok) {
            throw new Error(`HTTP ${response.status}: ${response.statusText}`);
        }
        
        const data = await response.json();
        return data;
    } catch (error) {
        // Network error
        if (error.name === 'TypeError') {
            console.error('Network error:', error.message);
        } 
        // HTTP error
        else {
            console.error('HTTP error:', error.message);
        }
        throw error;
    }
}

// Usage
try {
    const data = await fetchWithErrorHandling('https://api.example.com/data');
} catch (error) {
    // Handle error in UI
    showErrorMessage(error.message);
}
</code></pre>

            <h2>Request Options</h2>

            <pre><code class="language-javascript">const response = await fetch(url, {
    // HTTP method
    method: 'POST', // GET, POST, PUT, DELETE, PATCH, etc.
    
    // Request headers
    headers: {
        'Content-Type': 'application/json',
        'Authorization': 'Bearer your-token-here',
        'Accept': 'application/json'
    },
    
    // Request body (for POST, PUT, PATCH)
    body: JSON.stringify({
        key: 'value'
    }),
    
    // CORS mode
    mode: 'cors', // cors, no-cors, same-origin
    
    // Credentials (cookies)
    credentials: 'include', // include, same-origin, omit
    
    // Cache mode
    cache: 'no-cache', // default, no-cache, reload, force-cache, only-if-cached
    
    // Redirect handling
    redirect: 'follow', // follow, error, manual
    
    // Referrer policy
    referrerPolicy: 'no-referrer',
    
    // Abort signal (for cancellation)
    signal: abortController.signal
});
</code></pre>

            <h2>Response Methods</h2>

            <pre><code class="language-javascript">const response = await fetch(url);

// Parse response body
const json = await response.json();           // Parse as JSON
const text = await response.text();           // Get as plain text
const blob = await response.blob();           // Get as Blob (files)
const formData = await response.formData();   // Parse as FormData
const arrayBuffer = await response.arrayBuffer(); // Get as ArrayBuffer

// Response properties
console.log(response.ok);          // true if status 200-299
console.log(response.status);      // HTTP status code (200, 404, etc.)
console.log(response.statusText);  // Status message ("OK", "Not Found")
console.log(response.headers);     // Headers object
console.log(response.url);         // Final URL (after redirects)
console.log(response.redirected);  // Was redirected?
console.log(response.type);        // Response type (basic, cors, etc.)

// Get specific header
const contentType = response.headers.get('Content-Type');
</code></pre>

            <h2>Real-World Examples</h2>

            <h3>API Client Class</h3>

            <pre><code class="language-javascript">class ApiClient {
    constructor(baseUrl) {
        this.baseUrl = baseUrl;
        this.token = null;
    }
    
    setToken(token) {
        this.token = token;
    }
    
    async request(endpoint, options = {}) {
        const url = `${this.baseUrl}${endpoint}`;
        
        const headers = {
            'Content-Type': 'application/json',
            ...options.headers
        };
        
        if (this.token) {
            headers['Authorization'] = `Bearer ${this.token}`;
        }
        
        const response = await fetch(url, {
            ...options,
            headers
        });
        
        if (!response.ok) {
            const error = await response.json().catch(() => ({}));
            throw new Error(error.message || `HTTP ${response.status}`);
        }
        
        return response.json();
    }
    
    get(endpoint) {
        return this.request(endpoint, { method: 'GET' });
    }
    
    post(endpoint, data) {
        return this.request(endpoint, {
            method: 'POST',
            body: JSON.stringify(data)
        });
    }
    
    put(endpoint, data) {
        return this.request(endpoint, {
            method: 'PUT',
            body: JSON.stringify(data)
        });
    }
    
    delete(endpoint) {
        return this.request(endpoint, { method: 'DELETE' });
    }
}

// Usage
const api = new ApiClient('https://api.example.com');
api.setToken('my-auth-token');

const users = await api.get('/users');
const newUser = await api.post('/users', { name: 'John' });
await api.delete('/users/123');
</code></pre>

            <h3>Request Timeout</h3>

            <pre><code class="language-javascript">async function fetchWithTimeout(url, options = {}, timeout = 5000) {
    const controller = new AbortController();
    const timeoutId = setTimeout(() => controller.abort(), timeout);
    
    try {
        const response = await fetch(url, {
            ...options,
            signal: controller.signal
        });
        
        clearTimeout(timeoutId);
        return response;
    } catch (error) {
        clearTimeout(timeoutId);
        
        if (error.name === 'AbortError') {
            throw new Error('Request timeout');
        }
        throw error;
    }
}

// Usage
try {
    const response = await fetchWithTimeout('https://api.example.com/slow', {}, 3000);
    const data = await response.json();
} catch (error) {
    console.error('Request failed:', error.message);
}
</code></pre>

            <h3>Retry Logic</h3>

            <pre><code class="language-javascript">async function fetchWithRetry(url, options = {}, retries = 3) {
    for (let i = 0; i < retries; i++) {
        try {
            const response = await fetch(url, options);
            
            if (response.ok) {
                return response;
            }
            
            // Don't retry client errors (4xx)
            if (response.status >= 400 && response.status < 500) {
                throw new Error(`HTTP ${response.status}`);
            }
            
            // Retry server errors (5xx)
            if (i < retries - 1) {
                await new Promise(resolve => setTimeout(resolve, 1000 * (i + 1)));
                continue;
            }
            
            throw new Error(`HTTP ${response.status}`);
        } catch (error) {
            if (i === retries - 1) throw error;
            await new Promise(resolve => setTimeout(resolve, 1000 * (i + 1)));
        }
    }
}

// Usage
const response = await fetchWithRetry('https://api.example.com/data');
const data = await response.json();
</code></pre>

            <h2>Best Practices</h2>

            <div class="tip-box">
                <strong>1. Always check response.ok</strong>
                <pre><code class="language-javascript">if (!response.ok) {
    throw new Error(`HTTP ${response.status}`);
}
</code></pre>
            </div>

            <div class="tip-box">
                <strong>2. Use async/await for cleaner code</strong>
                <pre><code class="language-javascript">// Good
const data = await fetch(url).then(r => r.json());

// Better
const response = await fetch(url);
const data = await response.json();
</code></pre>
            </div>

            <div class="tip-box">
                <strong>3. Handle errors properly</strong>
                <pre><code class="language-javascript">try {
    const response = await fetch(url);
    if (!response.ok) throw new Error(`HTTP ${response.status}`);
    const data = await response.json();
} catch (error) {
    console.error('Fetch failed:', error);
}
</code></pre>
            </div>

            <div class="tip-box">
                <strong>4. Set appropriate headers</strong>
                <pre><code class="language-javascript">headers: {
    'Content-Type': 'application/json',
    'Authorization': `Bearer ${token}`
}
</code></pre>
            </div>

            <h2>Key Takeaways</h2>

            <ul>
                <li>Fetch returns Promises - use async/await</li>
                <li>Always check <code>response.ok</code> for HTTP errors</li>
                <li>Fetch only rejects on network errors, not HTTP errors</li>
                <li>Parse response with <code>.json()</code>, <code>.text()</code>, etc.</li>
                <li>Set headers and options for custom requests</li>
                <li>Use AbortController for request cancellation</li>
                <li>Implement retry logic for failed requests</li>
                <li>Handle both network and HTTP errors</li>
            </ul>

            <div class="lesson-nav">
                <a href="index.html" class="btn btn-secondary">← Back to Overview</a>
                <a href="/tutorials/javascript/index.html" class="btn btn-primary">More JavaScript Tutorials →</a>
            </div>
        </div>
    </main>

    <footer class="footer">
        <div class="container">
            <p>&copy; 2024 rws8.tech. All rights reserved.</p>
            <div class="social-links">
                <a href="https://github.com/bohdaq" target="_blank">GitHub</a>
                <a href="https://www.linkedin.com/in/bohdan-tsap/" target="_blank">LinkedIn</a>
            </div>
        </div>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"></script>
</body>
</html>
